<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>AÅŸk Puzzle ðŸ’–</title>

<style>
    body {
        margin: 0;
        padding: 0;
        background: radial-gradient(circle, #ffb3d9, #ff4da6, #cc0066);
        font-family: 'Playfair Display', serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
    }

    #game {
        display: flex;
        flex-direction: row;
        gap: 20px;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        max-width: 95%;
    }

    /* Sol taraftaki parÃ§alar */
    #pieces {
        width: 330px;
        height: 330px;
        background: rgba(255,255,255,0.9);
        border-radius: 20px;
        padding: 10px;
        box-shadow: 0 0 25px rgba(0,0,0,0.4);
        display: flex;
        flex-wrap: wrap;
        overflow: auto;
        justify-content: center;
        touch-action: none;
    }

    .piece {
        width: 55px;
        height: 55px;
        margin: 5px;
        background-size: 330px 330px;
        border-radius: 5px;
        cursor: grab;
        position: absolute;
        touch-action: none;
    }

    /* Puzzle tahtasÄ± */
    #board {
        width: 330px;
        height: 330px;
        background: rgba(255,245,250,0.95);
        border-radius: 20px;
        display: grid;
        grid-template-columns: repeat(6, 55px);
        grid-template-rows: repeat(6, 55px);
        gap: 5px;
        padding: 10px;
        box-shadow: 0 0 25px rgba(0,0,0,0.4);
        position: relative;
    }

    .slot {
        width: 55px;
        height: 55px;
        background: #ffe0f0;
        border-radius: 5px;
        position: relative;
    }

    #winBox {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 25px;
        border-radius: 20px;
        text-align: center;
        width: 300px;
        box-shadow: 0 0 30px rgba(0,0,0,0.5);
        color: #b30047;
        font-size: 1.2em;
        z-index: 10;
    }

    #winBox button {
        margin-top: 15px;
        padding: 10px 20px;
        border: none;
        background: #ff4da6;
        color: white;
        border-radius: 10px;
        font-size: 1em;
        cursor: pointer;
    }

</style>
</head>
<body>

<div id="game">
    <div id="pieces"></div>
    <div id="board"></div>
</div>

<div id="winBox">
    ðŸ’– Tebrikler AÅŸkÄ±m! ðŸ’–<br><br>
    Puzzle'Ä± baÅŸarÄ±yla tamamladÄ±n!<br><br>

    <button onclick="location.href='yenibolum3.html'">â¬… Geri</button>
    <button onclick="location.href='finalson.html'">Ä°leri âžœ</button>
</div>

<script>
/* =============================
      AYARLAR
============================= */

const rows = 6;
const cols = 6;
const total = rows * cols;
const img = "images/Puzzle1.jpg";

const piecesArea = document.getElementById("pieces");
const board = document.getElementById("board");

let pieces = [];
let dragData = null;

/* === SLOT OLUÅžTUR === */
for (let i = 0; i < total; i++) {
    let s = document.createElement("div");
    s.classList.add("slot");
    s.dataset.index = i;
    board.appendChild(s);
}

/* === PARÃ‡A OLUÅžTUR === */
for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {

        let p = document.createElement("div");
        p.classList.add("piece");

        let index = i * cols + j;
        p.dataset.index = index;

        p.style.backgroundImage = `url(${img})`;
        p.style.backgroundPosition = `-${j * 55}px -${i * 55}px`;

        pieces.push(p);
    }
}

pieces.sort(() => Math.random() - 0.5);
pieces.forEach(p => {
    piecesArea.appendChild(p);
    p.style.position = "relative";
});

/* =============================
   DRAG - TOUCH FONKSÄ°YONLARI
============================= */

pieces.forEach(piece => {

    piece.addEventListener("pointerdown", startDrag);
    piece.addEventListener("pointermove", dragMove);
    piece.addEventListener("pointerup", endDrag);
    piece.addEventListener("pointercancel", endDrag);
});

function startDrag(e) {
    dragData = {
        elem: e.target,
        startX: e.clientX,
        startY: e.clientY,
        origX: e.target.offsetLeft,
        origY: e.target.offsetTop,
    };

    e.target.style.zIndex = "999";
}

function dragMove(e) {
    if (!dragData) return;

    let dx = e.clientX - dragData.startX;
    let dy = e.clientY - dragData.startY;

    dragData.elem.style.transform =
        `translate(${dx}px, ${dy}px)`;
}

function endDrag(e) {
    if (!dragData) return;

    let piece = dragData.elem;
    let dropSuccess = false;

    piece.style.zIndex = "1";

    /* Slotlara bak */
    document.querySelectorAll(".slot").forEach(slot => {

        let rect = slot.getBoundingClientRect();
        let x = e.clientX;
        let y = e.clientY;

        if (x > rect.left && x < rect.right &&
            y > rect.top && y < rect.bottom) {

            /* DOÄžRU SLOT MU? */
            if (slot.dataset.index === piece.dataset.index) {

                piece.style.position = "absolute";
                piece.style.left = rect.left - board.getBoundingClientRect().left + "px";
                piece.style.top = rect.top - board.getBoundingClientRect().top + "px";
                piece.style.transform = "none";

                slot.appendChild(piece);
                piece.style.cursor = "default";

                dropSuccess = true;

                checkWin();
            }
        }
    });

    if (!dropSuccess) {
        piece.style.transform = "none";
    }

    dragData = null;
}

/* == KAZANMA KONTROLÃœ == */
function checkWin() {
    let correct = 0;

    document.querySelectorAll(".slot").forEach(slot => {
        if (slot.children.length > 0) {
            let p = slot.children[0];
            if (p.dataset.index === slot.dataset.index) {
                correct++;
            }
        }
    });

    if (correct === total) {
        document.getElementById("winBox").style.display = "block";
    }
}
</script>

</body>
</html>